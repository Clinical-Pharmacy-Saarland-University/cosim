Sat 25 Feb 2023 06:48:23 AM CET
;; 1. Based on: 3109
;; 2. Description: Hosp BA2, Hosp+Vent BA45, cp hosp+ICU, est RR_Hosp_O+Hosp+hill(2), cp Hosp+ICU+death, hosp(XBB), MTIME(dout), GER first
;; x1. Author: dings





;; 3. Label: LD_B_L(MT), hosp(MT,NT,A,D,V), dout(MT,PQ), dKH(PQ), ICU(MT,A,V,D)
;; Kommentar: Für die Simulationen zukünftiger Impfungen muss die Anzahl an Impfungen auf die Erstimpfung und mit 6 Wochen Zeitverzug auf die Zweitimpfungen addiert werden

$SIZES NO=-10000 PD=-5000 LVR=50 PC=33 PG=-500

$PROBLEM COVID-19 cases

$INPUT ID Week Year STATE=DROP DROP TIME TIME2 DV OBS CMT AMT EVID MDV NUMBER CASE0 DIVIFLAG SCHOOLS STORECLOSURE CURFEW RESTRAININGORDER CARNIVAL FLAGZEROOBS FLAGRKI FLAGMP DOSING2 Zweit05to14 Zweit15to59 Zweit60 ZweitGesamt Booster05to14 Booster15to59 Booster60 BoosterGesamt EWZ_0 EWZ_5 EWZ_15 EWZ_60 EWZ_Gesamt T0 A00toA04_M A00toA04_W A05toA14_M A05toA14_W A15toA34_M A15toA34_W A35toA59_M A35toA59_W A60toA79_M A60toA79_W A80_M A80_W Positivenquote Positivenquote_DE AnzahlTestungen PREDIC fixR0_61 fixCP_61 fixR0_60 fixCP_60 fixR0_59 fixCP_59 fixR0_58 fixCP_58 fixR0_57 fixCP_57 fixR0_56 fixCP_56 fixR0_55 fixCP_55 fixR0_54 fixCP_54 fixR0_53 fixCP_53 fixR0_52 fixCP_52 fixR0_51 fixCP_51 fixR0_50 fixCP_50 fixR0_49 fixCP_49 fixR0_48 fixCP_48 fixR0_47 fixCP_47 fixR0_46 fixCP_46 fixR0_45 fixCP_45 fixR0_44 fixCP_44 fixR0_43 fixCP_43 fixR0_0 fixR0_1 fixR0_2 fixR0_3 fixR0_4 fixR0_5 fixR0_6 fixR0_7 fixR0_8 fixR0_9 fixR0_10 fixR0_11 fixR0_12 fixR0_13 fixR0_14 fixR0_15 fixR0_16 fixR0_17 fixR0_18 fixR0_19 fixR0_20 fixR0_21 fixR0_22 fixR0_23 fixR0_24 fixR0_25 fixR0_26 fixR0_27 fixR0_28 fixR0_29 fixR0_30 fixR0_31 fixR0_32 fixR0_33 fixR0_34 fixR0_35 fixR0_36 fixR0_37 fixR0_38 fixR0_39 fixR0_40 fixR0_41 fixR0_42 fixCP_4 fixCP_5 fixCP_6 fixCP_7 fixCP_8 fixCP_9 fixCP_10 fixCP_11 fixCP_12 fixCP_13 fixCP_14 fixCP_15 fixCP_16 fixCP_17 fixCP_18 fixCP_19 fixCP_20 fixCP_21 fixCP_22 fixCP_23 fixCP_24 fixCP_25 fixCP_26 fixCP_27 fixCP_28 fixCP_29 fixCP_30 fixCP_31 fixCP_32 fixCP_33 fixCP_34 fixCP_35 fixCP_36 fixCP_37 fixCP_38 fixCP_39 fixCP_40 fixCP_41 fixCP_42 fixF2 fixR0FREE MDVLAST
$DATA COVID_ds_257_Impf_VOC_Betten_V3_R0_3014_44.csv IGNORE=@ IGNORE(ID.EQ.17) IGNORE(DOSING2.EQ.1) IGNORE(DIVIFLAG.EQ.2) IGNORE(CMT.EQ.8) IGNORE(CMT.EQ.11) IGNORE(CMT.EQ.12) IGNORE(CMT.EQ.9) IGNORE(FLAGZEROOBS.EQ.1) IGNORE(FLAGRKI.EQ.1) IGNORE(PREDIC.EQ.1)
$SUBROUTINES ADVAN6 TOL=4
$MODEL NCOMPS=32

$PK
fBER = 1
IF(ID.EQ.3) fBER = 1.52
fHE = 1
IF(ID.EQ.7) fHE = 1.15
fBR = 1
IF(ID.EQ.5) fBR = 1.3 
CP_BR = 0
IF(TIME.GT.1005) CP_BR = 1 ;ab 23.09.2022 werden in Bremen nur noch Gesamtbelegung des KH berichtet
fHH = 1
fHH_KH = 1
IF(ID.EQ.6) fHH = 1.2
IF(ID.EQ.6.AND.TIME.GE.569) fHH_KH = 1.2 ;ab 13.07.2021 werden in HH nur noch stationär gesamt gemeldet (Patienten mit und ohne Wohnsitz in Hamburg)

R0START = fixR0_0

COV1 = SCHOOLS
E1 = fixR0_1
COV2 = CARNIVAL
E2 = fixR0_2
COV3 = MAX(CURFEW,RESTRAININGORDER)
E3 = fixR0_3
MTDIFF = 1
MTIME(1) = fixCP_4
COV4 = MPAST(1)
E4 = fixR0_4
MTIME(2) = fixCP_5
COV5 = MPAST(2)
E5 = fixR0_5
MTIME(3) = fixCP_6
COV6 = MPAST(3)
E6 = fixR0_6
MTIME(4) = fixCP_7
COV7 = MPAST(4)
E7 = fixR0_7
MTIME(7) = fixCP_8
COV8 = MPAST(7)
E8 = fixR0_8
MTIME(8) = fixCP_9
COV9 = MPAST(8)
E9 = fixR0_9
MTIME(9) = fixCP_10
COV10 = MPAST(9)
E10 = fixR0_10
MTIME(11) = fixCP_11
COV11 = MPAST(11)
E11 =fixR0_11
MTIME(12) = fixCP_12
COV12 = MPAST(12)
E12 = fixR0_12
MTIME(13) = fixCP_13
COV13 = MPAST(13)
E13 = fixR0_13
MTIME(14) = fixCP_14
COV14 = MPAST(14)
E14 = fixR0_14
MTIME(16) = fixCP_15
COV15 = MPAST(16)
E15= fixR0_15
MTIME(17) = fixCP_16
COV16= MPAST(17)
E16= fixR0_16
MTIME(18) = fixCP_17
COV17= MPAST(18)
E17= fixR0_17
MTIME(19) = fixCP_18
COV18= MPAST(19)
E18= fixR0_18
MTIME(20) = fixCP_19
COV19= MPAST(20)
E19= fixR0_19
MTIME(21) = fixCP_20
COV20 = MPAST(21)
E20= fixR0_20
MTIME(22) = fixCP_21
COV21 = MPAST(22)
E21 = fixR0_21
MTIME(23) = fixCP_22
COV22 = MPAST(23)
E22 = fixR0_22
MTIME(24) = fixCP_23
COV23 = MPAST(24)
E23 = fixR0_23
MTIME(25) = fixCP_24
COV24 = MPAST(25)
E24 = fixR0_24
MTIME(26) = fixCP_25
COV25 = MPAST(26)
E25= fixR0_25
MTIME(26) = fixCP_25
COV25 = MPAST(26)
E25= fixR0_25
MTIME(27) = fixCP_26
COV26 = MPAST(27)
E26= fixR0_26
MTIME(28) = fixCP_27
COV27 = MPAST(28)
E27= fixR0_27
MTIME(29) = fixCP_28
COV28 = MPAST(29)
E28= fixR0_28
MTIME(30) = fixCP_29
COV29 = MPAST(30)
E29= fixR0_29
MTIME(31) = fixCP_30
COV30 = MPAST(31)
E30= fixR0_30
MTIME(32) = fixCP_31
COV31 = MPAST(32)
E31= fixR0_31
MTIME(33) = fixCP_32
COV32 = MPAST(33)
E32= fixR0_32
MTIME(34) = fixCP_33
COV33 = MPAST(34)
E33= fixR0_33
MTIME(35) = fixCP_34
COV34 = MPAST(35)
E34= fixR0_34
MTIME(36) = fixCP_35
COV35 = MPAST(36)
E35= fixR0_35
MTIME(37) = fixCP_36
COV36 = MPAST(37)
E36= fixR0_36
MTIME(38) = fixCP_37
COV37 = MPAST(38)
E37= fixR0_37
MTIME(39) = fixCP_38
COV38 = MPAST(39)
E38= fixR0_38
MTIME(40) = fixCP_39
COV39 = MPAST(40)
E39= fixR0_39
MTIME(41) = fixCP_40
COV40 = MPAST(41)
E40 = fixR0_40
MTIME(42) = fixCP_41
COV41 = MPAST(42)
E41 = fixR0_41
MTIME(43) = fixCP_42
COV42 = MPAST(43)
E42 = fixR0_42
MTIME(44) = fixCP_43
COV43 = MPAST(44)
E43 = fixR0_43
MTIME(45) = fixCP_44
COV44 = MPAST(45)
E44 = fixR0_44
MTIME(47) = fixCP_45
COV45 = MPAST(47)
E45 = fixR0_45
MTIME(48) = fixCP_46
COV46 = MPAST(48)
E46 = fixR0_46
MTIME(49) = fixCP_47
COV47 = MPAST(49)
E47 = fixR0_47
MTIME(50) = fixCP_48
COV48 = MPAST(50)
E48 = fixR0_48
MTIME(51) = fixCP_49
COV49 = MPAST(51)
E49 = fixR0_49
MTIME(53) = fixCP_50
COV50 = MPAST(53)
E50 = fixR0_50
MTIME(54) = fixCP_51
COV51 = MPAST(54)
E51 = fixR0_51
MTIME(55) = fixCP_52
COV52 = MPAST(55)
E52 = fixR0_52
MTIME(56) = fixCP_53
COV53 = MPAST(56)
E53 = fixR0_53
MTIME(57) = fixCP_54
COV54 = MPAST(57)
E54 = fixR0_54
MTIME(58) = fixCP_55
COV55 = MPAST(58)
E55 = fixR0_55
MTIME(60) = fixCP_56
COV56 = MPAST(60)
E56 = fixR0_56
MTIME(61) = fixCP_57
COV57 = MPAST(61)
E57 = fixR0_57
MTIME(63) = fixCP_58
COV58 = MPAST(63)
E58 = fixR0_58
MTIME(64) = fixCP_59
COV59 = MPAST(64)
E59 = fixR0_59
MTIME(65) = fixCP_60
COV60 = MPAST(65)
E60 = fixR0_60
MTIME(66) = fixCP_61
COV61 = MPAST(66)
E61 = fixR0_61

R0FREE_OLD = R0START*(1-COV1)+E2*COV2+E1*(COV1-COV3)+E3*(COV3-COV4)+E4*(COV4-COV5)+E5*(COV5-COV6)+E6*(COV6-COV7)+E7*(COV7-COV8)+E8*(COV8-COV9)+E9*(COV9-COV10)+E10*(COV10-COV11)+E11*(COV11-COV12)+E12*(COV12-COV13)+E13*(COV13-COV14)+E14*(COV14-COV15)+E15*(COV15-COV16)+E16*(COV16-COV17)+E17*(COV17-COV18)+E18*(COV18-COV19)+E19*(COV19-COV20)+E20*(COV20-COV21)+E21*(COV21-COV22)+E22*(COV22-COV23)+E23*(COV23-COV24)+E24*(COV24-COV25)+E25*(COV25-COV26)+E26*(COV26-COV27)+E27*(COV27-COV28)+E28*(COV28-COV29)+E29*(COV29-COV30)+E30*(COV30-COV31)+E31*(COV31-COV32)+E32*(COV32-COV33)+E33*(COV33-COV34)+E34*(COV34-COV35)+E35*(COV35-COV36)+E36*(COV36-COV37)+E37*(COV37-COV38)+E38*(COV38-COV39)+E39*(COV39-COV40)+E40*(COV40-COV41)+E41*(COV41-COV42)+E42*(COV42-COV43)+E43*(COV43-COV44)+E44*(COV44-COV45)+E45*(COV45-COV46)+E46*(COV46-COV47)+E47*(COV47-COV48)+E48*(COV48-COV49)+E49*(COV49-COV50)+E50*(COV50-COV51)+E51*(COV51-COV52)+E52*(COV52-COV53)+E53*(COV53-COV54)+E54*(COV54-COV55)+E55*(COV55-COV56)+E56*(COV56-COV57)+E57*(COV57-COV58)+E58*(COV58-COV59)+E59*(COV59-COV60)+E60*(COV60-COV61)+E61*COV61

F2 = fixF2
ALAG2 = 9

isolation = 100
infectious = 7

gamma = 1/(infectious)

;Parameter VOC Alpha
StarttagAlpha= 347
kAlpha=0.072
initAlpha=0.002
FractionInfectious_A = 0.08 ;Fraction infectious after vaccination for Alpha+Wildtype
DSMAlpha = TIME-StarttagAlpha
IF(TIME.LT.StarttagAlpha) DSMAlpha = 0

;Parameter VOC Delta
StarttagDelta = 347+154
kDelta= 0.13
initDelta= 0.002
FaktorDelta = 1.97 ;Factor Delta vs WT
FractionInfectious_D = 0.15 ;Fraction infectious after vaccination for Delta
FractionInfectious_BD = 0.15 ;Fraction infectious after booster for Delta
DSMDelta = TIME-StarttagDelta
IF(TIME.LT.StarttagDelta) DSMDelta = 0

;Parameter VOC Omicron
StarttagOmicron = 347+T0
MTIME(10) = StarttagOmicron
kOmicron= 0.21
initOmicron= 0.002
FaktorOmicron = 1.97*1.62 ;Factor Omicron vs WT
FractionInfectious_O = 1 ;Fraction infectious after vaccination for Omicron
FractionInfectious_BO = 0.25 + MPAST(45)*0.75*(TIME-MTIME(45))**3/((TIME-MTIME(45))**3+180**3) ;Fraction infectious after booster for Omicron

DSMOmicron = (TIME-StarttagOmicron)*MPAST(10)

;Parameter VOC Omicron BA.2
StarttagBA2 = 347+T0
kBA2= 0.0689
initBA2= 0.002
FaktorBA2 = 1.97*1.62*1.5 ;Factor BA2 vs WT
DSMBA2 = (TIME-StarttagBA2)*MPAST(10)
;Parameter VOC Omicron BA.4_5
StarttagBA4_5 = 347+500
kBA4_5= 0.122
initBA4_5= 0.002
FaktorBA4_5 = 1.97*1.62*1.5*1.77     ;Factor BA4_5 vs WT
DSMBA4_5 = (TIME-StarttagBA4_5)*MPAST(10)

;Parameter VOC Omicron XBB
StarttagXBB = 347+732
kXBB= 0.077
initXBB= 0.002
FaktorXBB = 1.97*1.62*1.5*1.77*1.13  ;Factor XBB vs WT
DSMXBB = (TIME-StarttagXBB)*MPAST(10)

AnteilAlpha = 0.92/(1+((1-initAlpha)/initAlpha)*EXP(-kAlpha*DSMAlpha))
AnteilDelta= 0.99/(1+((1-initDelta)/initDelta)*EXP(-kDelta*DSMDelta))
AnteilOmicron= 1/(1+((1-initOmicron)/initOmicron)*EXP(-kOmicron*DSMOmicron))*MPAST(10)
AnteilBA2 = 1/(1+((1-initBA2)/initBA2)*EXP(-kBA2*DSMBA2))*MPAST(10)
AnteilBA4_5 = 1/(1+((1-initBA4_5)/initBA4_5)*EXP(-kBA4_5*DSMBA4_5))*MPAST(10)
AnteilXBB = 1/(1+((1-initXBB)/initXBB)*EXP(-kXBB*DSMXBB))*MPAST(10)
RR_Inf = FractionInfectious_A*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + FractionInfectious_D*(AnteilDelta-AnteilOmicron*0.99) + FractionInfectious_O*AnteilOmicron

FractionInfectious = FractionInfectious_A*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + FractionInfectious_D*(AnteilDelta-AnteilOmicron*0.99) + FractionInfectious_O*AnteilOmicron
FractionInfectious_Booster = FractionInfectious_A*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + FractionInfectious_BD*(AnteilDelta-AnteilOmicron*0.99) + FractionInfectious_BO*AnteilOmicron

A00toA04_M_COV = A00toA04_M;/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A00toA04_W_COV = A00toA04_W;/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A05toA14_M_COV = A05toA14_M;/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A05toA14_W_COV = A05toA14_W;/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A15toA34_M_COV = A15toA34_M;*(1-Factor15)/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A15toA34_W_COV = A15toA34_W;*(1-Factor15)/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A35toA59_M_COV = A35toA59_M;*(1-Factor35)/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A35toA59_W_COV = A35toA59_W;*(1-Factor35)/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A60toA79_M_COV = A60toA79_M;*(1-Factor60)/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A60toA79_W_COV = A60toA79_W;*(1-Factor60)/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A80_M_COV = A80_M;*(1-Factor80)/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))
A80_W_COV = A80_W;*(1-Factor80)/(1-Factor80*(A80_M+A80_W)-Factor60*(A60toA79_M+A60toA79_W)-Factor35*(A35toA59_M+A35toA59_W)-Factor15*(A15toA34_M+A15toA34_W))

PQ= Positivenquote
IF(Positivenquote.LT.0.1) PQ=0.1

MTIME(6) = 646
F_INF = 6

RR_Inf = FractionInfectious_A*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + FractionInfectious_D*(AnteilDelta-AnteilOmicron*0.99)*F_INF**MPAST(6) + FractionInfectious_O*AnteilOmicron

RR_Inf_Booster = FractionInfectious_A*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + FractionInfectious_BD*(AnteilDelta-AnteilOmicron*0.99) + FractionInfectious_BO*AnteilOmicron; 0.08 ;DOI: 10.1056/NEJMoa2101765
F_Hosp_new = 3.78
RR_Hosp_WT_60 = 0.12;(1-0.748)
RR_Hosp_WT_00 = 0.08;(1-0.782)
RR_Hosp_D_60 = 0.12 /(1+0.284)   ;0.38
RR_Hosp_D_00 = 0.08 /(1+0.284)   ;0.38
RR_Hosp_O = THETA(27)
RR_Hosp_60 = (RR_Hosp_WT_60*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + RR_Hosp_D_60*(AnteilDelta-AnteilOmicron*0.99)*F_Hosp_new**MPAST(6) + RR_Hosp_O*AnteilOmicron)
RR_Hosp_00 = (RR_Hosp_WT_00*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + RR_Hosp_D_00*(AnteilDelta-AnteilOmicron*0.99)*F_Hosp_new**MPAST(6) + RR_Hosp_O*AnteilOmicron)
RR_Hosp_60_Booster = (RR_Hosp_WT_60*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + RR_Hosp_D_60*(AnteilDelta-AnteilOmicron*0.99) + RR_Hosp_O*AnteilOmicron)
RR_Hosp_00_Booster = (RR_Hosp_WT_00*(1-(AnteilDelta-AnteilOmicron*0.99)-AnteilOmicron) + RR_Hosp_D_00*(AnteilDelta-AnteilOmicron*0.99) + RR_Hosp_O*AnteilOmicron)

FKH = 0.458
hill2 = 100  
hosptrans = 100

MTIME(52) = THETA(15)
F_Hosp_all = 1*THETA(18)**MPAST(52)
MTIME(15) = THETA(20) 
IF(ID.EQ.1) F_Hosp_all = THETA(17)**MPAST(6)
IF(ID.EQ.2) F_Hosp_all = THETA(18)**MPAST(6)
IF(ID.EQ.3) F_Hosp_all = THETA(18)**MPAST(6)
IF(ID.EQ.4) F_Hosp_all = THETA(18)**MPAST(6)
IF(ID.EQ.7) F_Hosp_all = THETA(17)**(MPAST(52)-MPAST(15))*THETA(18)**MPAST(15)
IF(ID.EQ.9) F_Hosp_all = THETA(17)**MPAST(52)
IF(ID.EQ.12) F_Hosp_all = 1.07**(MPAST(6)-MPAST(52))*THETA(18)**MPAST(52)
IF(ID.EQ.13) F_Hosp_all = THETA(18)**MPAST(6)
IF(ID.EQ.14) F_Hosp_all = THETA(18)**MPAST(6)
IF(ID.EQ.15) F_Hosp_all = THETA(17)**(MPAST(52)-MPAST(15))*THETA(18)**MPAST(15)
IF(ID.EQ.16) F_Hosp_all = THETA(19)**MPAST(52)
IF(ID.EQ.17) F_Hosp_all = THETA(1)**(MPAST(6)-MPAST(52))*THETA(18)**MPAST(52)

MTIME(46) = 600
hill_2022 = THETA(10)
hill_2022_2 = THETA(29)
FHosp_2022 = (1-THETA(9)*(MPAST(46)*(TIME-600))**hill_2022/((MPAST(46)*(TIME-600))**hill_2022+(THETA(6)-600)**hill_2022))*(1+THETA(21)*(MPAST(15)*(TIME-THETA(20)))**hill_2022_2/((MPAST(15)*(TIME-THETA(20)))**hill_2022_2+(THETA(28)-THETA(20))**hill_2022_2))
MTIME(62) = 789
FKHnTEST = THETA(5)
FKHnTEST2 = THETA(24)
NTests = EXP(-FKHnTEST*AnzahlTestungen/1000000)*(1-MPAST(62)) + EXP(-FKHnTEST2*AnzahlTestungen/1000000)*MPAST(62)
hospfactor = F_Hosp_all*FHosp_2022*(1-FKH*TIME**hill2/(280**hill2+TIME**hill2))*NTests*(1+(AnteilAlpha-AnteilDelta*0.92/0.99)*0.124)*(1+AnteilDelta*0.284)*(1+AnteilOmicron*(-0.589))*(1+AnteilBA2*THETA(14))*(1+AnteilBA4_5*THETA(11))*(1+AnteilXBB*THETA(31))

;Hosprates decrease with increasing vaccination according to the estimated rate of cases that is vaccinated: 
;RR_Inf*Geimpft80/Agegroup80/(1-Geimpft80/Agegroup80*(1-RR_Inf))
Hosp0 = 0.0735*0.999*hospfactor
Hosp5 = 0.0178*0.999*hospfactor
Hosp15= 0.0305*0.999*hospfactor
Hosp35= 0.148*0.999*hospfactor
Hosp60= 0.578*0.999*hospfactor
IF(Hosp60.GT.1) Hosp60 = 1
Hosp80= 0.999*hospfactor
IF(Hosp80.GT.1) Hosp80 = 1

Ungeimpft = 1 - ZweitGesamt - BoosterGesamt
AnteilUngeimpft05 = 1 - Zweit05to14 - Booster05to14
AnteilUngeimpft15 = 1 - Zweit15to59 - Booster15to59
AnteilUngeimpft60 = 1 - Zweit60 - Booster60
All05 = AnteilUngeimpft05+Zweit05to14*RR_Inf+Booster05to14*RR_Inf_Booster
All15 = AnteilUngeimpft15+Zweit15to59*RR_Inf+Booster15to59*RR_Inf_Booster
All60 = AnteilUngeimpft60+Zweit60*RR_Inf+Booster60*RR_Inf_Booster

H0 = Hosp0*(A00toA04_M_COV+A00toA04_W_COV*0.817)
H5 = Hosp5*(A05toA14_M_COV+A05toA14_W_COV)        /All05*(AnteilUngeimpft05+RR_Hosp_00*RR_Inf*Zweit05to14+RR_Hosp_00_Booster*RR_Inf_Booster*Booster05to14)
H15 = Hosp15*(A15toA34_M_COV+A15toA34_W_COV*1.55) /All15*(AnteilUngeimpft15+RR_Hosp_00*RR_Inf*Zweit15to59+RR_Hosp_00_Booster*RR_Inf_Booster*Booster15to59)
H35 = Hosp35*(A35toA59_M_COV+A35toA59_W_COV*0.597)/All15*(AnteilUngeimpft15+RR_Hosp_00*RR_Inf*Zweit15to59+RR_Hosp_00_Booster*RR_Inf_Booster*Booster15to59)
H60 = Hosp60*(A60toA79_M_COV+A60toA79_W_COV*0.708)/All60*(AnteilUngeimpft60+RR_Hosp_60*RR_Inf*Zweit60+RR_Hosp_60_Booster*RR_Inf_Booster*Booster60)
H80 = Hosp80*(A80_M_COV+A80_W_COV*0.588)          /All60*(AnteilUngeimpft60+RR_Hosp_60*RR_Inf*Zweit60+RR_Hosp_60_Booster*RR_Inf_Booster*Booster60)

hosp_TV = H0+H5+H15+H35+H60+H80
hosp = hosp_TV
isolated = (1-hosp)*isolation
hospitalized = hosp*isolation

POP1 = 0
POP2 = 0
IF(ID.EQ.2) POP1 = 1
IF(ID.EQ.3) POP1 = 1
IF(ID.EQ.5) POP1 = 1
IF(ID.EQ.6) POP1 = 1
IF(ID.EQ.7) POP1 = 1
IF(ID.EQ.10) POP1 = 1
IF(ID.EQ.12) POP1 = 1
IF(ID.EQ.17) POP2 = 1

FICU_2022 = (1-THETA(7)*(MPAST(46)*(TIME-600))**hill_2022/((MPAST(46)*(TIME-600))**hill_2022+(THETA(6)-600)**hill_2022))*(1+THETA(22)*(MPAST(15)*(TIME-THETA(20)))**hill_2022_2/((MPAST(15)*(TIME-THETA(20) ))**hill_2022_2+(THETA(28)-THETA(20))**hill_2022_2))
CPs_ICU = (0.478+(POP1*0.171+(1-POP1)*0+POP2*0.0976)*TIME**hill2/(280**hill2+TIME**hill2))*FICU_2022*THETA(25)**MPAST(15)
FICU= CPs_ICU*(1+(AnteilAlpha-AnteilDelta*0.92/0.99)*0.474)*(1+AnteilDelta*0.546)*(1+AnteilOmicron*THETA(2))*(1+AnteilBA4_5*THETA(12))

I0 = 0.439*FICU
IF(I0.GT.1) I0 = 1
I5 = 0.363*FICU
IF(I5.GT.1) I5 = 1
I15 = 0.41*FICU
IF(I15.GT.1) I15 = 1
I35 = 0.66*FICU
IF(I35.GT.1) I35 = 1
I60 = FICU
IF(I60.GT.1) I60 = 1
I80 = 0.65*FICU
IF(I80.GT.1) I80 = 1

RR_ICU_00 = 0.05*14
RR_ICU_60 = 0.07*14

ICU0 = Hosp0*(A00toA04_M_COV+A00toA04_W_COV*0.817*0.255)*I0/hosp_TV
ICU5 = Hosp5*(A05toA14_M_COV+A05toA14_W_COV*0.299)*I5/hosp_TV/All05*(AnteilUngeimpft05+RR_ICU_00*RR_Hosp_00*RR_Inf*Zweit05to14+RR_ICU_00*RR_Hosp_00_Booster*RR_Inf_Booster*Booster05to14)
ICU15 = Hosp15*(A15toA34_M_COV+A15toA34_W_COV*1.55*0.435)*I15/hosp_TV/All15*(AnteilUngeimpft15+RR_ICU_00*RR_Hosp_00*RR_Inf*Zweit15to59+RR_ICU_00*RR_Hosp_00_Booster*RR_Inf_Booster*Booster15to59)
ICU35 = Hosp35*(A35toA59_M_COV+A35toA59_W_COV*0.597*0.600)*I35/hosp_TV/All15*(AnteilUngeimpft15+RR_ICU_00*RR_Hosp_00*RR_Inf*Zweit15to59+RR_ICU_00*RR_Hosp_00_Booster*RR_Inf_Booster*Booster15to59)
ICU60 = Hosp60*(A60toA79_M_COV+A60toA79_W_COV*0.708*0.652)*I60/hosp_TV/All60*(AnteilUngeimpft60+RR_ICU_60*RR_Hosp_60*RR_Inf*Zweit60+RR_ICU_60*RR_Hosp_60_Booster*RR_Inf_Booster*Booster60)
ICU80 = Hosp80*(A80_M_COV+A80_W_COV*0.588*0.608)*I80/hosp_TV/All60*(AnteilUngeimpft60+RR_ICU_60*RR_Hosp_60*RR_Inf*Zweit60+RR_ICU_60*RR_Hosp_60_Booster*RR_Inf_Booster*Booster60)

revFRACTHOSP =(ICU0+ICU5+ICU15+ICU35+ICU60+ICU80)
FRACTHOSP = 1-revFRACTHOSP
toKH =  hosptrans*FRACTHOSP

; FRACTION ICU (non ventilated)

F_VENT =  (1+AnteilOmicron*THETA(3))*(1+AnteilBA4_5*THETA(16))
B0 = ICU0/revFRACTHOSP*0.308*F_VENT
B5 = ICU5/revFRACTHOSP*0.444*F_VENT
B15 = ICU15/revFRACTHOSP*0.463*F_VENT
B35 = ICU35/revFRACTHOSP*0.600*F_VENT
B60 = ICU60/revFRACTHOSP*0.719*F_VENT
B80 = ICU80/revFRACTHOSP*0.666*F_VENT
FRACTBEAT = (B0+B5+B15+B35+B60+B80)
FRACTICU = 1-FRACTBEAT
toICU = hosptrans*(1-FRACTHOSP)*FRACTICU
toBEAT = hosptrans*(1-FRACTHOSP)*(1-FRACTICU)

KHu60_M = (1-0.66*FICU)*(Hosp35*A35toA59_M_COV/All15*(AnteilUngeimpft15+RR_Hosp_00*RR_Inf*Zweit15to59+RR_Hosp_00_Booster*RR_Inf_Booster*Booster15to59))/hosp_TV/FRACTHOSP
KHue60_M = (1-FICU)*(Hosp60*A60toA79_M_COV/All60*(AnteilUngeimpft60+RR_Hosp_60*RR_Inf*Zweit60+RR_Hosp_60_Booster*RR_Inf_Booster*Booster60))/hosp_TV/FRACTHOSP
KHue80_M = (1-0.65*FICU)*(Hosp80*A80_M_COV/All60*(AnteilUngeimpft60+RR_Hosp_60*RR_Inf*Zweit60+RR_Hosp_60_Booster*RR_Inf_Booster*Booster60))/hosp_TV/FRACTHOSP
KHu60_W = (1-0.600*0.66*FICU)*(Hosp35*A35toA59_W_COV*0.597/All15*(AnteilUngeimpft15+RR_Hosp_00*RR_Inf*Zweit15to59+RR_Hosp_00_Booster*RR_Inf_Booster*Booster15to59))/hosp_TV/FRACTHOSP
KHue60_W = (1-0.652*FICU)*(Hosp60*A60toA79_W_COV*0.708/All60*(AnteilUngeimpft60+RR_Hosp_60*RR_Inf*Zweit60+RR_Hosp_60_Booster*RR_Inf_Booster*Booster60))/hosp_TV/FRACTHOSP
KHue80_W = (1-0.608*0.65*FICU)*(Hosp80*A80_W_COV*0.588/All60*(AnteilUngeimpft60+RR_Hosp_60*RR_Inf*Zweit60+RR_Hosp_60_Booster*RR_Inf_Booster*Booster60))/hosp_TV/FRACTHOSP
ICUue35 = ICU35*(1-0.6*F_VENT)/revFRACTHOSP/FRACTICU
ICUue60 =  ICU60*(1-0.719*F_VENT)/revFRACTHOSP/FRACTICU
ICUue80 =  ICU80*(1-0.666*F_VENT)/revFRACTHOSP/FRACTICU
Bue05 = (B5)/(FRACTBEAT+0.001)
Bue15 = (B15)/(FRACTBEAT+0.001)
Bue35 = (B35)/(FRACTBEAT+0.001)
Bue60 = (B60)/(FRACTBEAT+0.001)
Bue80 = (B80)/(FRACTBEAT+0.001)

PQdeath = (1.23-1.23*0.509*EXP(-PQ*0.0697))*(1-MPAST(62)) + THETA(26)*MPAST(62)
PQdeathICU = (1.23-1.23*0.509*EXP(-3.12*0.0697))*(1-MPAST(62)) + THETA(26)*MPAST(62)
FDeath_2022 = (1-THETA(8)*(MPAST(46)*(TIME-600))**hill_2022/((MPAST(46)*(TIME-600))**hill_2022+(THETA(6)-600)**hill_2022))*(1+THETA(30)*(MPAST(15)*(TIME-THETA(20)))**hill_2022_2/((MPAST(15)*(TIME-THETA(20) ))**hill_2022_2+(THETA(28)-THETA(20))**hill_2022_2))
KHd = (0.0125*KHu60_M+0.0125*KHu60_W+0.147*KHue60_M+0.101*KHue60_W+0.414*KHue80_M+0.334*KHue80_W)*(1+(AnteilAlpha-AnteilDelta*0.92/0.99)*0)*(1+AnteilDelta*0)*PQdeath*(1+AnteilOmicron*(-0.577))*(1+AnteilBA4_5*THETA(13))*FDeath_2022
KHd80 = 0.414*PQdeath*(1+(AnteilAlpha-AnteilDelta*0.92/0.99)*0)*(1+AnteilDelta*0)*(1+AnteilOmicron*(-0.577))*(1+AnteilBA4_5*THETA(13))*FDeath_2022
ICUd = (0.0453*ICUue35+0.193*ICUue60+0.477*ICUue80) *(1+(AnteilAlpha-AnteilDelta*0.92/0.99)*0)*(1+AnteilDelta*0)*PQdeath*(1+AnteilOmicron*(-0.577))*(1+AnteilBA4_5*THETA(13))*FDeath_2022
BEATd = (0.25*Bue05+0.18*Bue15+0.372*Bue35+0.653*Bue60+0.841*Bue80) *(1+(AnteilAlpha-AnteilDelta*0.92/0.99)*0)*(1+AnteilDelta*0)*PQdeathICU*(1+AnteilOmicron*(-0.577))*(1+AnteilBA4_5*THETA(13))*FDeath_2022


hill3 = 20.3
FDOUT = 0.27*TIME**hill3/(TIME**hill3+348**hill3)
hill4 = 100
FDOUT2 = 0.864*0.27*TIME**hill4/(TIME**hill4+443**hill4)
RR_Death = 0.16*0 ;DOI: 10.1056/NEJMoa2101765
MTIME(67) = THETA(32)

out80M = A80_M_COV*((1-Hosp80)*AnteilUngeimpft60+(1-Hosp80*RR_Inf*RR_Hosp_60*RR_Death)*Zweit60+(1-Hosp80*RR_Inf_Booster*RR_Hosp_60_Booster*RR_Death)*Booster60)/All60
out80W = A80_W_COV*((1-Hosp80*0.588)*AnteilUngeimpft60+(1-Hosp80*0.588*RR_Inf*RR_Hosp_60*RR_Death)*Zweit60+(1-Hosp80*0.588*RR_Inf_Booster*RR_Hosp_60_Booster*RR_Death)*Booster60)/All60
out60M = A60toA79_M_COV*((1-Hosp60)*AnteilUngeimpft60+(1-Hosp60*RR_Inf*RR_Hosp_60*RR_Death)*Zweit60+(1-Hosp60*RR_Inf_Booster*RR_Hosp_60_Booster*RR_Death)*Booster60)/All60
out60W = A60toA79_W_COV*((1-Hosp60*0.708)*AnteilUngeimpft60+(1-Hosp60*0.708*RR_Inf*RR_Hosp_60*RR_Death)*Zweit60+(1-Hosp60*0.708*RR_Inf_Booster*RR_Hosp_60_Booster*RR_Death)*Booster60)/All60

OUTd = (0+FDOUT-FDOUT2)*PQdeath*(1+(AnteilAlpha-AnteilDelta*0.92/0.99)*0)*(1+AnteilDelta*0)*(1+AnteilOmicron*(-0.577))*(1+AnteilBA4_5*THETA(13))*FDeath_2022*(1-MPAST(67))
death = (out80M+out80W*0.334/0.414+(out60M+out60W*0.101/0.147)*1.22/10.1)*OUTd   ;Verhältnis rate M/W wie Sterberate Normalstation; Verhältnis Ü60/Ü80 = 1.22/10.1 (=Saarland)

;----- Metakis
IIV1 = EXP(ETA(1))
hill1 = 100
F_LD_BEAT_L = (1.69-(1.69*0.407)*TIME**hill1/(TIME**hill1+225**hill1))
F_LD_ICU = (1+AnteilOmicron*THETA(4))
;;;;Metakis-Information;;;;
LD_BEAT_D = 15.5  ;Liegedauer Beatmet verstorben
LD_BEAT_L = 28.6*F_LD_BEAT_L ;Liegedauer Beatmet entlassen
LD_ICU_D = 20 ;Liegedauer ICU verstorben
LD_ICU_L = 20.4 ;Liegedauer ICU entlassen
LD_KH_D = 10.6 ;Liegedauer KH verstorben
LD_KH_L = 11.5 ;Liegedauer KH entlassen
P_BEAT_AUFENTHALT_D = 0.63*F_LD_ICU;Beatmung % Aufenthalt verstorben
P_BEAT_AUFENTHALT_L = 0.28*F_LD_ICU;Beatmung % Aufenthalt entlassen
P_BEAT_on_ICU_AUFENTHALT_D = 0.68*F_LD_ICU;beatmet ICU % Aufenthalt verstorben
P_BEAT_on_ICU_AUFENTHALT_L = 0.43*F_LD_ICU;beatmet ICU % Aufenthalt entlassen
P_ICU_AUFENTHALT_D = 0.44*F_LD_ICU;unbeatmet ICU % Aufenthalt verstorben
P_ICU_AUFENTHALT_L = 0.29*F_LD_ICU;unbeatmet ICU % Aufenthalt entlassen

LDdeathKH = LD_KH_D
LDdeathICU = LD_ICU_D
LDdeathBEAT = LD_BEAT_D
LDrecoveryKH = LD_KH_L
LDrecoveryICU = LD_ICU_L
LDrecoveryBEAT = LD_BEAT_L
deathKH = 2/(LD_KH_D)
deathICU = 2/(LD_ICU_D)
deathBEAT = 2/(LD_BEAT_D)
recovery_rateKH = 2/(LD_KH_L)
recovery_rateICU = 2/(LD_ICU_L)
recovery_rateBEAT = 2/(LD_BEAT_L)

MTIME(5) = 70
REC_TIME = MPAST(5)
recovery = 14
recovery_rate = 2/recovery
recovery_hosp = 14
recovery_ratehosp = 2/recovery_hosp
death_rate = 2/LD_KH_D

KHl = 1-KHd
ICUl = 1-ICUd
BEATl = 1-BEATd

Q_0 = 0
;IF(ID.EQ.2) Q_0=14;ein paar mehr f�r die Bayern
A_0(1) = NUMBER

$DES
DaysSinceAlpha = T-StarttagAlpha
IF(T.LT.StarttagAlpha) DaysSinceAlpha = 0
Alpha = 0.92/(1+((1-initAlpha)/initAlpha)*EXP(-kAlpha*DaysSinceAlpha))
IF(T.LT.StarttagAlpha) Alpha = 0

DaysSinceDelta = T-StarttagDelta
IF(T.LT.StarttagDelta) DaysSinceDelta = 0
Delta = 0.99/(1+((1-initDelta)/initDelta)*EXP(-kDelta*DaysSinceDelta))
IF(T.LT.StarttagDelta) Delta = 0

DaysSinceOmicron = (T-StarttagOmicron)*MPAST(10)
Omicron = 1/(1+((1-initOmicron)/initOmicron)*EXP(-kOmicron*DaysSinceOmicron))*MPAST(10)

DaysSinceBA2 = (T-StarttagBA2)*MPAST(10)
BA2 = 1/(1+((1-initBA2)/initBA2)*EXP(-kBA2*DaysSinceBA2))*MPAST(10)

DaysSinceBA4_5 = (T-StarttagBA4_5)*MPAST(10)
BA4_5 = 1/(1+((1-initBA4_5)/initBA4_5)*EXP(-kBA4_5*DaysSinceBA4_5))*MPAST(37)

DaysSinceXBB = (T-StarttagXBB)*MPAST(10)
XBB = 1/(1+((1-initXBB)/initXBB)*EXP(-kXBB*DaysSinceXBB))*MPAST(10)

R0FREE = R0FREE_OLD*((1-(Alpha-Delta*0.92/0.99)-(Delta-Omicron*0.99)-Omicron)+1.35*(Alpha-Delta*0.92/0.99) + FaktorDelta*(Delta-Omicron*0.99) + FaktorOmicron*Omicron*(1-BA2) + FaktorBA2*Omicron*(BA2-BA4_5) + FaktorBA4_5*Omicron*(BA4_5-XBB) + FaktorXBB*XBB)
beta = R0FREE*gamma
FractionInfectious_DES = FractionInfectious_A*(1-(Delta-Omicron*0.99)-Omicron) + FractionInfectious_D*(Delta-Omicron*0.99) + FractionInfectious_O*Omicron
FractionInfectious_Booster_DES = FractionInfectious_A*(1-(Delta-Omicron*0.99)-Omicron) + FractionInfectious_BD*(Delta-Omicron*0.99) + FractionInfectious_BO*Omicron

;Susceptibles
DADT(1) = - beta*A(1)/NUMBER*A(2)*(Ungeimpft+ZweitGesamt*FractionInfectious_DES+BoosterGesamt*FractionInfectious_Booster_DES)
;Infected
DADT(2) = beta*(A(1)+Omicron*A(30)+XBB*A(31))/NUMBER*A(2)*(Ungeimpft+ZweitGesamt*FractionInfectious_DES+BoosterGesamt*FractionInfectious_Booster_DES) - gamma*A(2) 
;Cumultaive cases
DADT(3) = gamma*A(2) - isolated*A(3) - hospitalized*A(3)
DADT(4) = isolated*A(3)*(1-death) - recovery_rate*A(4) 	            ;R1 
DADT(5) = KHl*toKH*A(26) - recovery_rateKH*A(5) 						;KH L 1
DADT(6) = recovery_rateKH*A(5) - recovery_rateKH*A(6)				;KH L 2
DADT(7) = KHd*toKH*A(26)- deathKH*A(7) 								;KH D 1
DADT(8) = deathKH*A(7) - deathKH*A(8) 								;KH D 1
DADT(9) = ICUl*toICU*A(26) - recovery_rateICU*A(9) 					;ICU L 1
DADT(10) = recovery_rateICU*A(9) - recovery_rateICU*A(10) 			;ICU L 2
DADT(11) = ICUd*toICU*A(26)- deathICU*A(11) 						;ICU D 1
DADT(12) = deathICU*A(11)- deathICU*A(12) 							;ICU D 2
DADT(13) = BEATl*toBEAT*A(26) - recovery_rateBEAT*A(13) 				;BEAT L 1
DADT(14) = recovery_rateBEAT*A(13) - recovery_rateBEAT*A(14) 		;BEAT L 2
DADT(15) = BEATd*toBEAT*A(26) - deathBEAT*A(15) 						;BEAT D 1
DADT(16) = deathBEAT*A(15)- deathBEAT*A(16) 						;BEAT D 2
DADT(17) = recovery_rate*A(20) +  recovery_ratehosp*A(24)           ;RECOVERED
DADT(18) = death_rate*A(29) +deathKH*A(8) + deathICU*A(12) + deathBEAT*A(16);DEAD
DADT(19) = gamma*A(2)                       ;total cases
DADT(20) = recovery_rate*A(4) - recovery_rate*A(20)   ;R2
DADT(21) = (toICU + toBEAT + toKH)*A(26)             ;KH kumulativ
DADT(22) = (toICU + toBEAT)*A(26)                    ;ICU kumulativ
DADT(23) = recovery_rateKH*A(6) + recovery_rateICU*A(10) + recovery_rateBEAT*A(14) - recovery_ratehosp*A(23) ;RKH1
DADT(24) = recovery_ratehosp*A(23) - recovery_ratehosp*A(24) ;RKH2
DADT(25) = hospitalized*A(3) - hosptrans*A(25);DEAD KH
DADT(26) = hosptrans*A(25) - hosptrans*A(26)
DADT(27) = death_rate*A(29) +deathKH*A(8) + deathICU*A(12) + deathBEAT*A(16);DEAD
DADT(28) = isolated*A(3)*death - death_rate*A(28)
DADT(29) = death_rate*A(28) - death_rate*A(29)
;Cases without Omicron --> susceptible to Omicron
DADT(30) = (1-Omicron)*gamma*A(2) - beta*Omicron*A(30)/NUMBER*A(2)*(Ungeimpft+ZweitGesamt*FractionInfectious_DES+BoosterGesamt*FractionInfectious_Booster_DES)
;Cases with Omicron --> immune after Omicron
DADT(31) = (Omicron-XBB)*gamma*A(2) - beta*XBB*A(31)/NUMBER*A(2)*(Ungeimpft+ZweitGesamt*FractionInfectious_DES+BoosterGesamt*FractionInfectious_Booster_DES)
;Cases with XBB --> immune after XBB
DADT(32) = XBB*gamma*A(2)

$ERROR
;Alpha
DaysSinceAlpha_Err = TIME-StarttagAlpha
IF(TIME.LT.StarttagAlpha) DaysSinceAlpha_Err = 0
Alpha_Err = 0.92/(1+((1-initAlpha)/initAlpha)*EXP(-kAlpha*DaysSinceAlpha_Err))
IF(TIME.LT.StarttagAlpha) Alpha_Err = 0
;Delta
DaysSinceDelta_Err = TIME-StarttagDelta
IF(TIME.LT.StarttagDelta) DaysSinceDelta_Err = 0
Delta_Err = 0.99/(1+((1-initDelta)/initDelta)*EXP(-kDelta*DaysSinceDelta_Err))
IF(TIME.LT.StarttagDelta) Delta_Err = 0
;Omicron
DaysSinceOmicron_Err = TIME-StarttagOmicron
IF(TIME.LT.StarttagOmicron) DaysSinceOmicron_Err = 0
Omicron_Err = 1/(1+((1-initOmicron)/initOmicron)*EXP(-kOmicron*DaysSinceOmicron_Err))
IF(TIME.LT.StarttagOmicron) Omicron_Err = 0
;BA.2
DaysSinceBA2_Err = TIME-StarttagBA2
IF(TIME.LT.StarttagBA2) DaysSinceBA2_Err = 0
BA2_Err = 1/(1+((1-initBA2)/initBA2)*EXP(-kBA2*DaysSinceBA2_Err))
IF(TIME.LT.StarttagBA2) BA2_Err = 0
;BA.4_5
DaysSinceBA4_5_Err = TIME-StarttagBA4_5
IF(TIME.LT.StarttagBA4_5) DaysSinceBA4_5_Err = 0
BA4_5_Err = 1/(1+((1-initBA4_5)/initBA4_5)*EXP(-kBA4_5*DaysSinceBA4_5_Err))
IF(TIME.LT.StarttagBA4_5) BA4_5_Err = 0
;XBB.1.5
DaysSinceXBB_Err = TIME-StarttagXBB
IF(TIME.LT.StarttagXBB) DaysSinceXBB_Err = 0
XBB_Err = 1/(1+((1-initXBB)/initXBB)*EXP(-kXBB*DaysSinceXBB_Err))
IF(TIME.LT.StarttagXBB) XBB_Err = 0
;R0FREE
R0 = R0FREE_OLD*((1-(Alpha_Err-Delta_Err*0.92/0.99)-(Delta_Err-Omicron_Err*0.99)-Omicron_Err)+1.35*(Alpha_Err-Delta_Err*0.92/0.99) + FaktorDelta*(Delta_Err-Omicron_Err*0.99) + FaktorOmicron*Omicron_Err*(1-BA2_Err) + FaktorBA2*Omicron_Err*(BA2_Err-BA4_5_Err) + FaktorBA4_5*Omicron_Err*(BA4_5_Err-XBB_Err)+FaktorXBB*XBB_Err)
SUSCEPTIBLES = A(1)
FractionInfectious_Err = FractionInfectious_A*(1-(Delta_Err-Omicron_Err*0.99)-Omicron_Err) + FractionInfectious_D*(Delta_Err-Omicron_Err*0.99) + FractionInfectious_O*Omicron_Err
FractionInfectious_Booster_Err = FractionInfectious_A*(1-(Delta_Err-Omicron_Err*0.99)-Omicron_Err) + FractionInfectious_BD*(Delta_Err-Omicron_Err*0.99) + FractionInfectious_BO*Omicron_Err
Rt = R0*(SUSCEPTIBLES+A(30)*Omicron_Err+A(5)*XBB_Err)/NUMBER*(Ungeimpft+ZweitGesamt*FractionInfectious_Err+BoosterGesamt*FractionInfectious_Booster_Err)

CASES = A(19)+Q_0
BEATMET = P_BEAT_AUFENTHALT_L*(A(13)+A(14))+P_BEAT_AUFENTHALT_D*(A(15)+A(16))
BEATMET_ABS = BEATMET
BEATMET_ICU = P_BEAT_on_ICU_AUFENTHALT_L*(A(13)+A(14))+P_BEAT_on_ICU_AUFENTHALT_D*(A(15)+A(16))
ICUgesamt = P_ICU_AUFENTHALT_L*(A(9)+A(10))+ P_ICU_AUFENTHALT_D*(A(11)+A(12))+BEATMET_ICU
ICU_ABS = ICUgesamt
KHgesamt = A(5)+A(6)+A(7)+A(8)+A(9)+A(10)+A(11)+A(12)+A(13)+A(14)+A(15)+A(16)
DAILY_DEAD = A(18)
DAILY_KH = A(21)
DEAD = A(27)
ICUkumulativ = A(22)
RECOVERED = CASE0+Q_0+A(17)*REC_TIME
IPRED = CASES
IF(CMT.EQ.4) IPRED = RECOVERED 
IF(CMT.EQ.5) IPRED= ICU_ABS*fBER*fBR*fHH
IF(CMT.EQ.6) IPRED = DEAD
IF(CMT.EQ.7) IPRED = KHgesamt*fBER*fHE*fHH_KH*fBR**CP_BR
IF(CMT.EQ.10) IPRED = BEATMET_ABS*fBER*fBR*fHH
IF(CMT.EQ.12) IPRED = ICUkumulativ
IF(CMT.EQ.18) IPRED = DAILY_DEAD
IF(CMT.EQ.21) IPRED = DAILY_KH
W = IPRED
DEL = 0
IF(IPRED.EQ.0) DEL = 0.001
IRES	= DV -  IPRED
IWRES   = IRES/(W+DEL)
Y  = IPRED *EXP(EPS(1)) + EPS(2)
IF(CMT.EQ.4) Y = IPRED + W*EPS(15) + EPS(16)
IF(CMT.EQ.5) Y = IPRED + W*EPS(3) + EPS(4)
IF(CMT.EQ.6) Y = IPRED + W*EPS(5)  + EPS(6)
IF(CMT.EQ.7) Y = IPRED + W*EPS(7) + EPS(8)
IF(CMT.EQ.10) Y = IPRED + W*EPS(9)  + EPS(10)
IF(CMT.EQ.18) Y = IPRED + W*EPS(11) + EPS(12)
IF(CMT.EQ.21) Y = IPRED + W*EPS(13) + EPS(14)

$THETA
(0, 0.911,2) FIX ;1 F_Hosp
(0) FIX ;2 F_ICU_Omicron
(-0.9, -0.364,0) ;3 F_Vent_Omicron
(0) FIX ;4 F_LD_ICU_Om
(0, 0.399) FIX ;5 FKHTests1
(600, 769,830) FIX ;6 MT ICU
(0, 0.774,1) ;7 F_ICU2022
(0, 0.615,1) ;8 F_Death2022
(0) FIX ;9 F_Hosp2022
(0, 17.7,50) FIX ;10 hill_2022
(-1, 0.572,10) ;11 F_Hosp_BA45 Zugewinn Hospitalisierungsrate durch BA4/5 
(0) FIX ;12 F_ICU_BA45 Zugewinn ICUrate durch BA4/5 
(0) FIX ;13 F_Death_BA45 Zugewinn Sterberate durch BA4/5 
(-1, -0.571,0) ;14 F_Hosp_BA2 Zugewinn Hospitalisierungsrate durch BA2 
(790, 828) FIX ;15 MT Hosp
(-1, -0.274,10) ;16 F_Vent_BA45
(0, 0.692,1) FIX ;17 F_Hosp
(0, 0.906,1) FIX ;18 F_Hosp
(0, 1.52,2) FIX ;19 F_Hosp
(850, 1010) FIX ;20 CP hosp
(-1, 2.39,10) ;21 Hosp 
(-1, 0.0416,10) ;22 ICU 
(1, 1.15) FIX ;23 FOmicron
(0, 0.247) FIX ;24 FKHTests2
(0, 0.903,2) FIX ;25 F_ICU
(0.4, 1.5) FIX ;26 PQ2
(0, 0.647,1) ;27 RR_Hosp_O Omicron
(1010, 1130,1140) ;28 MTIME
(1, 1.36,50) ;29 hill_2022_2
(-1, 2.28,10) ;30 death
(-1, 2.16) ;31 fhosp XBB
(1000, 1140) ;32 MTIME dout

$OMEGA
 0 FIX  ;1 hosptrans

$SIGMA 
 0.000026 ;prop c
 173000 ;add c
 0.0142 ;prop i
 3 FIX  ;add i
 0.000005 ;prop d
 144000 ;add d
 0.0122 ;prop k
 10 FIX  ;add k
 0.0223 ;prop v
 2 FIX  ;add v
 0.508 ;prop dd
 1 FIX  ;add dd
 6.54 ;prop dk
 3.32 ;add dk
 0.1 FIX  ;prop r
 10 FIX  ;add r

$EST METHOD=1 INTER MAXEVAL=0 NOABORT NSIG=2 SIGL=6 PRINT=1 POSTHOC
;$COV UNCOND

$TABLE ID TIME DV OBS CMT EVID MDV IPRED Rt R0FREE R0FREE_OLD hosp_TV hospfactor hosp FRACTHOSP FRACTICU KHd ICUd BEATd OUTd KHd80 death ONEHEADER NOPRINT FILE=sdtab3109R

NM-TRAN MESSAGES
  
 WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1
             
 (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.
             
 (WARNING  68) THE INT, MOD, MIN, OR MAX FUNCTION IS BEING USED OUTSIDE OF A
 SIMULATION BLOCK. IF THE FUNCTION VALUE AFFECTS THE VALUE OF THE
 OBJECTIVE FUNCTION, THEN AN ERROR WILL PROBABLY OCCUR.
             
 (WARNING  61) THERE IS A GAP IN THE SEQUENCE OF MTIME ELEMENTS. THIS
 ELEMENT IS NOT DEFINED, BUT ELEMENTS WITH LARGER INDICES ARE DEFINED:
     MTIME(059)

             
 (WARNING  48) DES-DEFINED ITEMS ARE COMPUTED ONLY WHEN EVENT TIME
 INCREASES. E.G., DISPLAYED VALUES ASSOCIATED WITH THE FIRST EVENT RECORD
 OF AN INDIVIDUAL RECORD ARE COMPUTED WITH (THE LAST ADVANCE TO) AN EVENT
 TIME OF THE PRIOR INDIVIDUAL RECORD.

License Registered to: Saarmetrics GmbH
Expiration Date:    14 APR 2023
Current Date:       25 FEB 2023
Days until program expires :  49
1NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) VERSION 7.4.3
 ORIGINALLY DEVELOPED BY STUART BEAL, LEWIS SHEINER, AND ALISON BOECKMANN
 CURRENT DEVELOPERS ARE ROBERT BAUER, ICON DEVELOPMENT SOLUTIONS,
 AND ALISON BOECKMANN. IMPLEMENTATION, EFFICIENCY, AND STANDARDIZATION
 PERFORMED BY NOUS INFOSYSTEMS.

 PROBLEM NO.:         1
 COVID-19 cases
0DATA CHECKOUT RUN:              NO
 DATA SET LOCATED ON UNIT NO.:    2
 THIS UNIT TO BE REWOUND:        NO
 NO. OF DATA RECS IN DATA SET:   155360
 NO. OF DATA ITEMS IN DATA SET: 176
 ID DATA ITEM IS DATA ITEM NO.:   1
 DEP VARIABLE IS DATA ITEM NO.:   6
 MDV DATA ITEM IS DATA ITEM NO.: 11
0INDICES PASSED TO SUBROUTINE PRED:
  10   4   9   0   0   0   8   0   0   0   0
0LABELS FOR DATA ITEMS:
 ID Week Year TIME TIME2 DV OBS CMT AMT EVID MDV NUMBER CASE0 DIVIFLAG SCHOOLS STORECLOSURE CURFEW RESTRAININGORDER
 CARNIVAL FLAGZEROOBS FLAGRKI FLAGMP DOSING2 Zweit05to14 Zweit15to59 Zweit60 ZweitGesamt Booster05to14 Booster15to59
 Booster60 BoosterGesamt EWZ_0 EWZ_5 EWZ_15 EWZ_60 EWZ_Gesamt T0 A00toA04_M A00toA04_W A05toA14_M A05toA14_W A15toA34_M
 A15toA34_W A35toA59_M A35toA59_W A60toA79_M A60toA79_W A80_M A80_W Positivenquote Positivenquote_DE AnzahlTestungen
 PREDIC fixR0_61 fixCP_61 fixR0_60 fixCP_60 fixR0_59 fixCP_59 fixR0_58 fixCP_58 fixR0_57 fixCP_57 fixR0_56 fixCP_56
 fixR0_55 fixCP_55 fixR0_54 fixCP_54 fixR0_53 fixCP_53 fixR0_52 fixCP_52 fixR0_51 fixCP_51 fixR0_50 fixCP_50 fixR0_49
 fixCP_49 fixR0_48 fixCP_48 fixR0_47 fixCP_47 fixR0_46 fixCP_46 fixR0_45 fixCP_45 fixR0_44 fixCP_44 fixR0_43 fixCP_43
 fixR0_0 fixR0_1 fixR0_2 fixR0_3 fixR0_4 fixR0_5 fixR0_6 fixR0_7 fixR0_8 fixR0_9 fixR0_10 fixR0_11 fixR0_12 fixR0_13
 fixR0_14 fixR0_15 fixR0_16 fixR0_17 fixR0_18 fixR0_19 fixR0_20 fixR0_21 fixR0_22 fixR0_23 fixR0_24 fixR0_25 fixR0_26
 fixR0_27 fixR0_28 fixR0_29 fixR0_30 fixR0_31 fixR0_32 fixR0_33 fixR0_34 fixR0_35 fixR0_36 fixR0_37 fixR0_38 fixR0_39
 fixR0_40 fixR0_41 fixR0_42 fixCP_4 fixCP_5 fixCP_6 fixCP_7 fixCP_8 fixCP_9 fixCP_10 fixCP_11 fixCP_12 fixCP_13 fixCP_14
 fixCP_15 fixCP_16 fixCP_17 fixCP_18 fixCP_19 fixCP_20 fixCP_21 fixCP_22 fixCP_23 fixCP_24 fixCP_25 fixCP_26 fixCP_27
 fixCP_28 fixCP_29 fixCP_30 fixCP_31 fixCP_32 fixCP_33 fixCP_34 fixCP_35 fixCP_36 fixCP_37 fixCP_38 fixCP_39 fixCP_40
 fixCP_41 fixCP_42 fixF2 fixR0FREE MDVLAST
0(NONBLANK) LABELS FOR PRED-DEFINED ITEMS:
 R0FREE_OLD hospfactor hosp_TV hosp FRACTHOSP FRACTICU KHd KHd80 ICUd BEATd OUTd death R0FREE Rt IPRED
0FORMAT FOR DATA:
 (58(3E21.0/),2E21.0)

 TOT. NO. OF OBS RECS:   112772
 TOT. NO. OF INDIVIDUALS:       16
0LENGTH OF THETA:  32
0DEFAULT THETA BOUNDARY TEST OMITTED:    NO
0OMEGA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:   1
0DEFAULT OMEGA BOUNDARY TEST OMITTED:    NO
0SIGMA HAS BLOCK FORM:
  1
  0  2
  0  0  3
  0  0  0  4
  0  0  0  0  5
  0  0  0  0  0  6
  0  0  0  0  0  0  7
  0  0  0  0  0  0  0  8
  0  0  0  0  0  0  0  0  9
  0  0  0  0  0  0  0  0  0 10
  0  0  0  0  0  0  0  0  0  0 11
  0  0  0  0  0  0  0  0  0  0  0 12
  0  0  0  0  0  0  0  0  0  0  0  0 13
  0  0  0  0  0  0  0  0  0  0  0  0  0 14
  0  0  0  0  0  0  0  0  0  0  0  0  0  0 15
  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 16
0DEFAULT SIGMA BOUNDARY TEST OMITTED:    NO
0INITIAL ESTIMATE OF THETA:
 LOWER BOUND    INITIAL EST    UPPER BOUND
  0.9110E+00     0.9110E+00     0.9110E+00
  0.0000E+00     0.0000E+00     0.0000E+00
 -0.9000E+00    -0.3640E+00     0.0000E+00
  0.0000E+00     0.0000E+00     0.0000E+00
  0.3990E+00     0.3990E+00     0.3990E+00
  0.7690E+03     0.7690E+03     0.7690E+03
  0.0000E+00     0.7740E+00     0.1000E+01
  0.0000E+00     0.6150E+00     0.1000E+01
  0.0000E+00     0.0000E+00     0.0000E+00
  0.1770E+02     0.1770E+02     0.1770E+02
 -0.1000E+01     0.5720E+00     0.1000E+02
  0.0000E+00     0.0000E+00     0.0000E+00
  0.0000E+00     0.0000E+00     0.0000E+00
 -0.1000E+01    -0.5710E+00     0.0000E+00
  0.8280E+03     0.8280E+03     0.8280E+03
 -0.1000E+01    -0.2740E+00     0.1000E+02
  0.6920E+00     0.6920E+00     0.6920E+00
  0.9060E+00     0.9060E+00     0.9060E+00
  0.1520E+01     0.1520E+01     0.1520E+01
  0.1010E+04     0.1010E+04     0.1010E+04
 -0.1000E+01     0.2390E+01     0.1000E+02
 -0.1000E+01     0.4160E-01     0.1000E+02
  0.1150E+01     0.1150E+01     0.1150E+01
  0.2470E+00     0.2470E+00     0.2470E+00
  0.9030E+00     0.9030E+00     0.9030E+00
  0.1500E+01     0.1500E+01     0.1500E+01
  0.0000E+00     0.6470E+00     0.1000E+01
  0.1010E+04     0.1130E+04     0.1140E+04
  0.1000E+01     0.1360E+01     0.5000E+02
 -0.1000E+01     0.2280E+01     0.1000E+02
 -0.1000E+01     0.2160E+01     0.1000E+07
  0.1000E+04     0.1140E+04     0.1000E+07
0INITIAL ESTIMATE OF OMEGA:
 0.0000E+00
0OMEGA CONSTRAINED TO BE THIS INITIAL ESTIMATE
0INITIAL ESTIMATE OF SIGMA:
 BLOCK SET NO.   BLOCK                                                                    FIXED
        1                                                                                   NO
                  0.2600E-04
        2                                                                                   NO
                  0.1730E+06
        3                                                                                   NO
                  0.1420E-01
        4                                                                                  YES
                  0.3000E+01
        5                                                                                   NO
                  0.5000E-05
        6                                                                                   NO
                  0.1440E+06
        7                                                                                   NO
                  0.1220E-01
        8                                                                                  YES
                  0.1000E+02
        9                                                                                   NO
                  0.2230E-01
       10                                                                                  YES
                  0.2000E+01
       11                                                                                   NO
                  0.5080E+00
       12                                                                                  YES
                  0.1000E+01
       13                                                                                   NO
                  0.6540E+01
       14                                                                                   NO
                  0.3320E+01
       15                                                                                  YES
                  0.1000E+00
       16                                                                                  YES
                  0.1000E+02
0TABLES STEP OMITTED:    NO
 NO. OF TABLES:           1
 SEED NUMBER (SEED):    11456
 RANMETHOD:             3U
 MC SAMPLES (ESAMPLE):    300
 WRES SQUARE ROOT TYPE (WRESCHOL): EIGENVALUE
0-- TABLE   1 --
0RECORDS ONLY:    ALL
04 COLUMNS APPENDED:    YES
 PRINTED:                NO
 HEADERS:               ONE
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 LFORMAT:
 RFORMAT:
 FIXED_EFFECT_ETAS:
0USER-CHOSEN ITEMS:
 ID TIME DV OBS CMT EVID MDV IPRED Rt R0FREE R0FREE_OLD hosp_TV hospfactor hosp FRACTHOSP FRACTICU KHd ICUd BEATd OUTd
 KHd80 death
1DOUBLE PRECISION PREDPP VERSION 7.4.3

 GENERAL NONLINEAR KINETICS MODEL (DVERK1, ADVAN6)
0MODEL SUBROUTINE USER-SUPPLIED - ID NO. 9999
0MAXIMUM NO. OF BASIC PK PARAMETERS:  53
0COMPARTMENT ATTRIBUTES
 COMPT. NO.   FUNCTION   INITIAL    ON/OFF      DOSE      DEFAULT    DEFAULT
                         STATUS     ALLOWED    ALLOWED    FOR DOSE   FOR OBS.
    1         COMP 1       ON         YES        YES        YES        YES
    2         COMP 2       ON         YES        YES        NO         NO
    3         COMP 3       ON         YES        YES        NO         NO
    4         COMP 4       ON         YES        YES        NO         NO
    5         COMP 5       ON         YES        YES        NO         NO
    6         COMP 6       ON         YES        YES        NO         NO
    7         COMP 7       ON         YES        YES        NO         NO
    8         COMP 8       ON         YES        YES        NO         NO
    9         COMP 9       ON         YES        YES        NO         NO
   10         COMP 10      ON         YES        YES        NO         NO
   11         COMP 11      ON         YES        YES        NO         NO
   12         COMP 12      ON         YES        YES        NO         NO
   13         COMP 13      ON         YES        YES        NO         NO
   14         COMP 14      ON         YES        YES        NO         NO
   15         COMP 15      ON         YES        YES        NO         NO
   16         COMP 16      ON         YES        YES        NO         NO
   17         COMP 17      ON         YES        YES        NO         NO
   18         COMP 18      ON         YES        YES        NO         NO
   19         COMP 19      ON         YES        YES        NO         NO
   20         COMP 20      ON         YES        YES        NO         NO
   21         COMP 21      ON         YES        YES        NO         NO
   22         COMP 22      ON         YES        YES        NO         NO
   23         COMP 23      ON         YES        YES        NO         NO
   24         COMP 24      ON         YES        YES        NO         NO
   25         COMP 25      ON         YES        YES        NO         NO
   26         COMP 26      ON         YES        YES        NO         NO
   27         COMP 27      ON         YES        YES        NO         NO
   28         COMP 28      ON         YES        YES        NO         NO
   29         COMP 29      ON         YES        YES        NO         NO
   30         COMP 30      ON         YES        YES        NO         NO
   31         COMP 31      ON         YES        YES        NO         NO
   32         COMP 32      ON         YES        YES        NO         NO
   33         OUTPUT       OFF        YES        NO         NO         NO
 INITIAL (BASE) TOLERANCE SETTINGS:
 NRD (RELATIVE) VALUE OF TOLERANCE:   4
 ANRD (ABSOLUTE) VALUE OF TOLERANCE:  12
1
 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG
 COMPT. NO.                             INDICES
              SCALE      BIOAVAIL.   ZERO-ORDER  ZERO-ORDER  ABSORB
                         FRACTION    RATE        DURATION    LAG
    1            *           *           *           *           *
    2            *          54           *           *          55
    3            *           *           *           *           *
    4            *           *           *           *           *
    5            *           *           *           *           *
    6            *           *           *           *           *
    7            *           *           *           *           *
    8            *           *           *           *           *
    9            *           *           *           *           *
   10            *           *           *           *           *
   11            *           *           *           *           *
   12            *           *           *           *           *
   13            *           *           *           *           *
   14            *           *           *           *           *
   15            *           *           *           *           *
   16            *           *           *           *           *
   17            *           *           *           *           *
   18            *           *           *           *           *
   19            *           *           *           *           *
   20            *           *           *           *           *
   21            *           *           *           *           *
   22            *           *           *           *           *
   23            *           *           *           *           *
   24            *           *           *           *           *
   25            *           *           *           *           *
   26            *           *           *           *           *
   27            *           *           *           *           *
   28            *           *           *           *           *
   29            *           *           *           *           *
   30            *           *           *           *           *
   31            *           *           *           *           *
   32            *           *           *           *           *
   33            *           -           -           -           -
             - PARAMETER IS NOT ALLOWED FOR THIS MODEL
             * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;
               WILL DEFAULT TO ONE IF APPLICABLE
0FIRST MODEL TIME PARAMETER ASSIGNED TO ROW NO.: 56
 LAST  MODEL TIME PARAMETER ASSIGNED TO ROW NO.:122
0DATA ITEM INDICES USED BY PRED ARE:
   EVENT ID DATA ITEM IS DATA ITEM NO.:     10
   TIME DATA ITEM IS DATA ITEM NO.:          4
   DOSE AMOUNT DATA ITEM IS DATA ITEM NO.:   9
   COMPT. NO. DATA ITEM IS DATA ITEM NO.:    8

0PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.
 PK SUBROUTINE CALLED AT NONEVENT (ADDITIONAL AND LAGGED) DOSE TIMES AND AT MODEL TIMES.

0PK SUBROUTINE INDICATES THAT COMPARTMENT AMOUNTS ARE INITIALIZED.
0ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.
0ERROR SUBROUTINE INDICATES THAT DERIVATIVES OF COMPARTMENT AMOUNTS ARE USED.
0DES SUBROUTINE USES COMPACT STORAGE MODE.

 #PARA: PARAFILE=pirana_auto_mpi.pnm, PROTOCOL=MPI, NODES= 6

1


 #TBLN:      1
 #METH: First Order Conditional Estimation with Interaction (Evaluation)

 ESTIMATION STEP OMITTED:                 YES
 ANALYSIS TYPE:                           POPULATION
 CONDITIONAL ESTIMATES USED:              YES
 CENTERED ETA:                            NO
 EPS-ETA INTERACTION:                     YES
 LAPLACIAN OBJ. FUNC.:                    NO
 NUMERICAL DERIVATIVE
       FILE REQUEST (NUMDER):               NONE
 MAP (ETAHAT) ESTIMATION METHOD (OPTMAP):   0
 ETA HESSIAN EVALUATION METHOD (ETADER):    0
 INITIAL ETA FOR MAP ESTIMATION (MCETA):    0
 SIGDIGITS FOR MAP ESTIMATION (SIGLO):      6
 GRADIENT SIGDIGITS OF
       FIXED EFFECTS PARAMETERS (SIGL):     6
 NOPRIOR SETTING (NOPRIOR):                 OFF
 NOCOV SETTING (NOCOV):                     OFF
 DERCONT SETTING (DERCONT):                 OFF
 FINAL ETA RE-EVALUATION (FNLETA):          ON
 EXCLUDE NON-INFLUENTIAL (NON-INFL.) ETAS
       IN SHRINKAGE (ETASTYPE):             NO
 NON-INFL. ETA CORRECTION (NONINFETA):      OFF
 RAW OUTPUT FILE (FILE): 3109R.ext
 EXCLUDE TITLE (NOTITLE):                   NO
 EXCLUDE COLUMN LABELS (NOLABEL):           NO
 FORMAT FOR ADDITIONAL FILES (FORMAT):      S1PE12.5
 PARAMETER ORDER FOR OUTPUTS (ORDER):       TSOL
 WISHART PRIOR DF INTERPRETATION (WISHTYPE):0
 KNUTHSUMOFF:                               0
 INCLUDE LNTWOPI:                           NO
 INCLUDE CONSTANT TERM TO PRIOR (PRIORC):   NO
 INCLUDE CONSTANT TERM TO OMEGA (ETA) (OLNTWOPI):NO
 ADDITIONAL CONVERGENCE TEST (CTYPE=4)?:    NO
 EM OR BAYESIAN METHOD USED:                 NONE

 TOLERANCES FOR ESTIMATION/EVALUATION STEP:
 NRD (RELATIVE) VALUE OF TOLERANCE:   4
 ANRD (ABSOLUTE) VALUE OF TOLERANCE:  12
 TOLERANCES FOR COVARIANCE STEP:
 NRD (RELATIVE) VALUE OF TOLERANCE:   4
 ANRD (ABSOLUTE) VALUE OF TOLERANCE:  12
 TOLERANCES FOR TABLE/SCATTER STEP:
 NRD (RELATIVE) VALUE OF TOLERANCE:   4
 ANRD (ABSOLUTE) VALUE OF TOLERANCE:  12

 THE FOLLOWING LABELS ARE EQUIVALENT
 PRED=PREDI
 RES=RESI
 WRES=WRESI
 IWRS=IWRESI
 IPRD=IPREDI
 IRS=IRESI

 Elapsed evaluation time in seconds:    77.68
 Elapsed postprocess time in seconds:   183.73
1
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************               FIRST ORDER CONDITIONAL ESTIMATION WITH INTERACTION              ********************
 #OBJT:**************                       MINIMUM VALUE OF OBJECTIVE FUNCTION                      ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 





 #OBJV:********************************************  1426298.764       **************************************************
1
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************               FIRST ORDER CONDITIONAL ESTIMATION WITH INTERACTION              ********************
 ********************                             FINAL PARAMETER ESTIMATE                           ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 


 THETA - VECTOR OF FIXED EFFECTS PARAMETERS   *********


         TH 1      TH 2      TH 3      TH 4      TH 5      TH 6      TH 7      TH 8      TH 9      TH10      TH11      TH12     
          TH13      TH14      TH15      TH16      TH17      TH18      TH19      TH20      TH21      TH22      TH23      TH24     
         TH25      TH26      TH27      TH28      TH29      TH30      TH31      TH32     
 
         9.11E-01  0.00E+00 -3.64E-01  0.00E+00  3.99E-01  7.69E+02  7.74E-01  6.15E-01  0.00E+00  1.77E+01  5.72E-01  0.00E+00
          0.00E+00 -5.71E-01  8.28E+02 -2.74E-01  6.92E-01  9.06E-01  1.52E+00  1.01E+03  2.39E+00  4.16E-02  1.15E+00  2.47E-01
         9.03E-01  1.50E+00  6.47E-01  1.13E+03  1.36E+00  2.28E+00  2.16E+00  1.14E+03
 


 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS  ********


         ETA1     
 
 ETA1
+        0.00E+00
 


 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS  ****


         EPS1      EPS2      EPS3      EPS4      EPS5      EPS6      EPS7      EPS8      EPS9      EP10      EP11      EP12     
          EP13      EP14      EP15      EP16     
 
 EPS1
+        2.60E-05
 
 EPS2
+        0.00E+00  1.73E+05
 
 EPS3
+        0.00E+00  0.00E+00  1.42E-02
 
 EPS4
+        0.00E+00  0.00E+00  0.00E+00  3.00E+00
 
 EPS5
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  5.00E-06
 
 EPS6
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  1.44E+05
 
 EPS7
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  1.22E-02
 
 EPS8
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  1.00E+01
 
 EPS9
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  2.23E-02
 
 EP10
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  2.00E+00
 
 EP11
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  5.08E-01
 
1

         EPS1      EPS2      EPS3      EPS4      EPS5      EPS6      EPS7      EPS8      EPS9      EP10      EP11      EP12     
          EP13      EP14      EP15      EP16     
 
 EP12
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  1.00E+00
 
 EP13
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
          6.54E+00
 
 EP14
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
          0.00E+00  3.32E+00
 
 EP15
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
          0.00E+00  0.00E+00  1.00E-01
 
 EP16
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
          0.00E+00  0.00E+00  0.00E+00  1.00E+01
 
1


 OMEGA - CORR MATRIX FOR RANDOM EFFECTS - ETAS  *******


         ETA1     
 
 ETA1
+        0.00E+00
 


 SIGMA - CORR MATRIX FOR RANDOM EFFECTS - EPSILONS  ***


         EPS1      EPS2      EPS3      EPS4      EPS5      EPS6      EPS7      EPS8      EPS9      EP10      EP11      EP12     
          EP13      EP14      EP15      EP16     
 
 EPS1
+        5.10E-03
 
 EPS2
+        0.00E+00  4.16E+02
 
 EPS3
+        0.00E+00  0.00E+00  1.19E-01
 
 EPS4
+        0.00E+00  0.00E+00  0.00E+00  1.73E+00
 
 EPS5
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  2.24E-03
 
 EPS6
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  3.79E+02
 
 EPS7
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  1.10E-01
 
 EPS8
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  3.16E+00
 
 EPS9
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  1.49E-01
 
 EP10
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  1.41E+00
 
 EP11
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  7.13E-01
 
 EP12
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  1.00E+00
 
 EP13
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
          2.56E+00
 
 EP14
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
          0.00E+00  1.82E+00
 
 EP15
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
          0.00E+00  0.00E+00  3.16E-01
 
 EP16
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
          0.00E+00  0.00E+00  0.00E+00  3.16E+00
 
 Elapsed finaloutput time in seconds:     8.18
 #CPUT: Total CPU Time in Seconds,      284.467
Stop Time:
Sat 25 Feb 2023 06:55:16 AM CET
